Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@urql/core"),t=require("react"),r=require("wonka"),n=e.createClient({url:"/graphql"}),u=t.createContext(n),a=u.Provider,o=u.Consumer;u.displayName="UrqlContext";var s=()=>t.useContext(u),i={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0},c=(e,t)=>{var r={...e,...t,data:void 0!==t.data||t.error?t.data:e.data,fetching:!!t.fetching,stale:!!t.stale};return((e,t)=>{if("object"!=typeof e||"object"!=typeof t)return e!==t;for(var r in e)if(!(r in t))return!0;for(var n in t)if(e[n]!==t[n])return!0;return!1})(e,r)?r:e},f=(e,t)=>{for(var r=0,n=t.length;r<n;r++)if(e[r]!==t[r])return!0;return!1};function l(n){var u=t.useRef(!0),a=s(),[o,c]=t.useState(i),f=t.useCallback(((t,o)=>(c({...i,fetching:!0}),r.toPromise(a.executeMutation(e.createRequest(n,t),o||{})).then((e=>(u.current&&c({fetching:!1,stale:!!e.stale,data:e.data,error:e.error,extensions:e.extensions,operation:e.operation}),e))))),[a,n,c]);return t.useEffect((()=>(u.current=!0,()=>{u.current=!1})),[]),[o,f]}function d(r,n){var u=t.useRef(void 0);return t.useMemo((()=>{var t=e.createRequest(r,n);return void 0!==u.current&&u.current.key===t.key?u.current:(u.current=t,t)}),[r,n])}function p(e){var n=s(),u=(e=>{if(!e._react){var t=new Set,n=new Map;e.operations$&&r.subscribe((e=>{"teardown"===e.kind&&t.has(e.key)&&(t.delete(e.key),n.delete(e.key))}))(e.operations$),e._react={get:e=>n.get(e),set(e,r){t.delete(e),n.set(e,r)},dispose(e){t.add(e)}}}return e._react})(n),a=((e,t)=>e.suspense&&(!t||!1!==t.suspense))(n,e.context),o=d(e.query,e.variables),l=t.useMemo((()=>{if(e.pause)return null;var t=n.executeQuery(o,{requestPolicy:e.requestPolicy,...e.context});return a?r.onPush((e=>{u.set(o.key,e)}))(t):t}),[u,n,o,a,e.pause,e.requestPolicy,e.context]),p=t.useCallback(((e,t)=>{if(!e)return{fetching:!1};var n=u.get(o.key);if(n){if(t&&null!=n&&"then"in n)throw n}else{var a,s=r.subscribe((e=>{n=e,a&&a(n)}))(r.takeWhile((()=>t&&!a||!n))(e));if(null==n&&t){var i=new Promise((e=>{a=e}));throw u.set(o.key,i),i}s.unsubscribe()}return n||{fetching:!0}}),[u,o]),v=[n,o,e.requestPolicy,e.context,e.pause],[x,y]=t.useState((()=>[l,c(i,p(l,a)),v])),b=x[1];l!==x[0]&&f(x[2],v)&&y([l,b=c(x[1],p(l,a)),v]),t.useEffect((()=>{var e=x[0],t=x[2][1],n=!1,a=e=>{n=!0,y((t=>{var r=c(t[1],e);return t[1]!==r?[t[0],r,t[2]]:t}))};if(e){var o=r.subscribe(a)(r.onEnd((()=>{a({fetching:!1})}))(e));return n||a({fetching:!0}),()=>{u.dispose(t.key),o.unsubscribe()}}a({fetching:!1})}),[u,x[0],x[2][1]]);var h=t.useCallback((t=>{var s={requestPolicy:e.requestPolicy,...e.context,...t};y((e=>[a?r.onPush((e=>{u.set(o.key,e)}))(n.executeQuery(o,s)):n.executeQuery(o,s),e[1],v]))}),[n,u,o,a,p,e.requestPolicy,e.context]);return[b,h]}function v(e,n){var u=s(),a=d(e.query,e.variables),o=t.useRef(n);o.current=n;var l=t.useMemo((()=>e.pause?null:u.executeSubscription(a,e.context)),[u,a,e.pause,e.context]),p=[u,a,e.context,e.pause],[v,x]=t.useState((()=>[l,{...i,fetching:!!l},p])),y=v[1];l!==v[0]&&f(v[2],p)&&x([l,y=c(v[1],{fetching:!!l}),p]),t.useEffect((()=>{var e=e=>{x((t=>{var r=c(t[1],e);return t[1]===r?t:(o.current&&t[1].data!==r.data&&(r.data=o.current(t[1].data,r.data)),[t[0],r,t[2]])}))};if(v[0])return r.subscribe(e)(r.onEnd((()=>{e({fetching:!!l})}))(v[0])).unsubscribe;e({fetching:!1})}),[v[0]]);var b=t.useCallback((t=>{var r=u.executeSubscription(a,{...e.context,...t});x((e=>[r,e[1],p]))}),[u,e.context,a]);return[y,b]}exports.Consumer=o,exports.Context=u,exports.Mutation=function(e){var t=l(e.query);return e.children({...t[0],executeMutation:t[1]})},exports.Provider=a,exports.Query=function(e){var t=p(e);return e.children({...t[0],executeQuery:t[1]})},exports.Subscription=function(e){var t=v(e,e.handler);return e.children({...t[0],executeSubscription:t[1]})},exports.useClient=s,exports.useMutation=l,exports.useQuery=p,exports.useSubscription=v,Object.keys(e).forEach((function(t){"default"===t||exports.hasOwnProperty(t)||Object.defineProperty(exports,t,{enumerable:!0,get:function(){return e[t]}})}));
//# sourceMappingURL=urql.min.js.map
