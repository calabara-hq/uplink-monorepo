import{createElement as e,useReducer as t,useMemo as r,useCallback as n}from"react";import i from"react-ssr-prepass";import{ssrExchange as a,dedupExchange as l,cacheExchange as o,fetchExchange as s,Provider as u}from"urql";import{createClient as p}from"@urql/core";var d,f=null;function v(){f=null}function g(e,t){var r="undefined"==typeof window;return!r&&f||((f=p({...e,suspense:t&&(r||e.suspense)})).toJSON=()=>null),f}function q(p,f){return f||(f={}),q=>{var c=Boolean((q.getInitialProps||f.ssr)&&!f.neverSuspend),m=({pageProps:i,urqlClient:m,urqlState:w,...C})=>{var[y,S]=t((e=>e+1),0),P=i&&i.urqlState||w,h=r((()=>{if(m&&!y)return m;d&&"undefined"!=typeof window?y||d.restoreData(P):d=a({initialState:P,isClient:!0,staleWhileRevalidate:"undefined"!=typeof window?f.staleWhileRevalidate:void 0});var e=p(d);return e.exchanges||(e.exchanges=[l,o,d,s]),g(e,c)}),[m,P,y]),x=n((()=>{v(),d=a({initialState:void 0}),S()}),[]);return e(u,{value:h},e(q,{...C,pageProps:i,urqlClient:h,resetUrqlClient:x}))};return m.displayName=`withUrqlClient(${q.displayName||q.name||"Component"})`,q.getLayout&&(m.getLayout=q.getLayout),(q.getInitialProps||f.ssr)&&(m.getInitialProps=async t=>{var r=t.AppTree,n=!!t.Component,u=n?t.ctx:t,d=a({initialState:void 0}),v=p(d,u);v.exchanges||(v.exchanges=[l,o,d,s]);var c=g(v,!f.neverSuspend);c&&(u.urqlClient=c);var m={};if(q.getInitialProps&&(m=await q.getInitialProps(t),u.res&&(u.res.writableEnded||u.res.finished)))return{...m,urqlClient:c};if("undefined"!=typeof window)return{...m,urqlClient:c};var w={...m,urqlClient:c},C=n?{pageProps:{},...w}:{pageProps:w};return f.neverSuspend||await i(e(r,C)),{...m,urqlState:d?d.extractData():void 0,urqlClient:c}}),m}}export{g as initUrqlClient,q as withUrqlClient};
//# sourceMappingURL=next-urql.min.es.js.map
