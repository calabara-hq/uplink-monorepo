scalar Decimal
scalar EditorData
scalar SubmissionAssetUrl
scalar ISODateString
extend type Contest @key(fields: "id") {
  id: ID!
  deadlines: Deadlines! @external
  additionalParams: AdditionalParams! @external
  submissions: [Submission!]!
    @requires(
      fields: "deadlines {startTime, voteTime, endTime, snapshot}, additionalParams {anonSubs, visibleVotes}"
    )
  gnosisResults: String @requires(fields: "deadlines {endTime}")
}

type Deadlines {
  startTime: ISODateString! @external
  voteTime: ISODateString! @external
  endTime: ISODateString! @external
  snapshot: ISODateString! @external
}

type AdditionalParams {
  anonSubs: Boolean! @external
  visibleVotes: Boolean! @external
}

type Space @key(fields: "id") {
  id: ID!
}

type Submission @key(fields: "id") {
  id: ID!
  contestId: ID!
  created: String!
  type: String!
  version: String!
  author: String
  url: String!
  totalVotes: Decimal
  rank: Int
}

type PopularSubmission @key(fields: "id") {
  id: ID!
  contestId: ID!
  created: String!
  type: String!
  version: String!
  author: String!
  url: String!
}

type Submit_Token {
  type: String!
  decimals: Int!
  symbol: String!
  address: String
  tokenId: String
}

type Submit_TokenRestriction {
  token: Submit_Token!
  threshold: Decimal!
}

type Submit_Restriction {
  restrictionType: String!
  tokenRestriction: Submit_TokenRestriction
}

type RestrictionResult {
  restriction: Submit_Restriction!
  result: Boolean!
}

type UserSubmissionParams {
  maxSubPower: Int!
  remainingSubPower: Int!
  restrictionResults: [RestrictionResult!]!
  userSubmissions: [Submission!]!
}

type Query {
  submission(submissionId: ID!): Submission
  popularSubmissions: [PopularSubmission!]!
  getUserSubmissionParams(
    contestId: ID!
  ): UserSubmissionParams!
}

type createSubmissionResponse {
  success: Boolean!
  userSubmissionParams: UserSubmissionParams!
}

input SubmissionPayload {
  title: String!
  previewAsset: SubmissionAssetUrl
  videoAsset: SubmissionAssetUrl
  body: EditorData
}

input ThreadPayload {
  text: String
  previewAsset: SubmissionAssetUrl
  videoAsset: SubmissionAssetUrl
  assetSize: Int
  assetType: String
}

input TwitterSubmissionPayload {
  title: String!
  thread: [ThreadPayload!]!
}

type Mutation {
  createSubmission(
    contestId: ID!
    submission: SubmissionPayload!
  ): createSubmissionResponse!
  createTwitterSubmission(
    contestId: ID!
    submission: TwitterSubmissionPayload!
  ): createSubmissionResponse!
}

extend schema
  @link(
    url: "https://specs.apollo.dev/federation/v2.0"
    import: ["@key", "@shareable", "@external", "@requires"]
  )
